{"ast":null,"code":"var ScrollOut = function () {\n  'use strict';\n\n  function clamp(v, min, max) {\n    return min > v ? min : max < v ? max : v;\n  }\n\n  function sign(x) {\n    return +(x > 0) - +(x < 0);\n  }\n\n  function round(n) {\n    return Math.round(n * 10000) / 10000;\n  }\n\n  var cache = {};\n\n  function replacer(match) {\n    return '-' + match[0].toLowerCase();\n  }\n\n  function hyphenate(value) {\n    return cache[value] || (cache[value] = value.replace(/([A-Z])/g, replacer));\n  }\n  /** find elements */\n\n\n  function $(e, parent) {\n    return !e || e.length === 0 ? // null or empty string returns empty array\n    [] : e.nodeName ? // a single element is wrapped in an array\n    [e] : // selector and NodeList are converted to Element[]\n    [].slice.call(e[0].nodeName ? e : (parent || document.documentElement).querySelectorAll(e));\n  }\n\n  function setAttrs(el, attrs) {\n    // tslint:disable-next-line:forin\n    for (var key in attrs) {\n      if (key.indexOf('_')) {\n        el.setAttribute('data-' + hyphenate(key), attrs[key]);\n      }\n    }\n  }\n\n  function setProps(cssProps) {\n    return function (el, props) {\n      for (var key in props) {\n        if (key.indexOf('_') && (cssProps === true || cssProps[key])) {\n          el.style.setProperty('--' + hyphenate(key), round(props[key]));\n        }\n      }\n    };\n  }\n\n  var clearTask;\n  var subscribers = [];\n\n  function loop() {\n    clearTask = 0;\n    subscribers.slice().forEach(function (s2) {\n      return s2();\n    });\n    enqueue();\n  }\n\n  function enqueue() {\n    if (!clearTask && subscribers.length) {\n      clearTask = requestAnimationFrame(loop);\n    }\n  }\n\n  function subscribe(fn) {\n    subscribers.push(fn);\n    enqueue();\n    return function () {\n      subscribers = subscribers.filter(function (s) {\n        return s !== fn;\n      });\n\n      if (!subscribers.length && clearTask) {\n        cancelAnimationFrame(clearTask);\n        clearTask = 0;\n      }\n    };\n  }\n\n  function unwrap(value, el, ctx, doc) {\n    return typeof value === 'function' ? value(el, ctx, doc) : value;\n  }\n\n  function noop() {}\n  /**\n   * Creates a new instance of ScrollOut that marks elements in the viewport with\n   * an \"in\" class and marks elements outside of the viewport with an \"out\"\n   */\n  // tslint:disable-next-line:no-default-export\n\n\n  function main(opts) {\n    // Apply default options.\n    opts = opts || {}; // Debounce onChange/onHidden/onShown.\n\n    var onChange = opts.onChange || noop;\n    var onHidden = opts.onHidden || noop;\n    var onShown = opts.onShown || noop;\n    var onScroll = opts.onScroll || noop;\n    var props = opts.cssProps ? setProps(opts.cssProps) : noop;\n    var se = opts.scrollingElement;\n    var container = se ? $(se)[0] : window;\n    var doc = se ? $(se)[0] : document.documentElement;\n    var rootChanged = false;\n    var scrollingElementContext = {};\n    var elementContextList = [];\n    var clientOffsetX, clientOffsety;\n    var sub;\n\n    function index() {\n      elementContextList = $(opts.targets || '[data-scroll]', $(opts.scope || doc)[0]).map(function (el) {\n        return {\n          element: el\n        };\n      });\n    }\n\n    function update() {\n      // Calculate position, direction and ratio.\n      var clientWidth = doc.clientWidth;\n      var clientHeight = doc.clientHeight;\n      var scrollDirX = sign(-clientOffsetX + (clientOffsetX = doc.scrollLeft || window.pageXOffset));\n      var scrollDirY = sign(-clientOffsety + (clientOffsety = doc.scrollTop || window.pageYOffset));\n      var scrollPercentX = doc.scrollLeft / (doc.scrollWidth - clientWidth || 1);\n      var scrollPercentY = doc.scrollTop / (doc.scrollHeight - clientHeight || 1); // Detect if the root context has changed.\n\n      rootChanged = rootChanged || scrollingElementContext.scrollDirX !== scrollDirX || scrollingElementContext.scrollDirY !== scrollDirY || scrollingElementContext.scrollPercentX !== scrollPercentX || scrollingElementContext.scrollPercentY !== scrollPercentY;\n      scrollingElementContext.scrollDirX = scrollDirX;\n      scrollingElementContext.scrollDirY = scrollDirY;\n      scrollingElementContext.scrollPercentX = scrollPercentX;\n      scrollingElementContext.scrollPercentY = scrollPercentY;\n      var childChanged = false;\n\n      for (var index_1 = 0; index_1 < elementContextList.length; index_1++) {\n        var ctx = elementContextList[index_1];\n        var element = ctx.element; // find the distance from the element to the scrolling container\n\n        var target = element;\n        var offsetX = 0;\n        var offsetY = 0;\n\n        do {\n          offsetX += target.offsetLeft;\n          offsetY += target.offsetTop;\n          target = target.offsetParent;\n        } while (target && target !== container); // Get element dimensions.\n\n\n        var elementHeight = element.clientHeight || element.offsetHeight || 0;\n        var elementWidth = element.clientWidth || element.offsetWidth || 0; // Find visible ratios for each element.\n\n        var visibleX = (clamp(offsetX + elementWidth, clientOffsetX, clientOffsetX + clientWidth) - clamp(offsetX, clientOffsetX, clientOffsetX + clientWidth)) / elementWidth;\n        var visibleY = (clamp(offsetY + elementHeight, clientOffsety, clientOffsety + clientHeight) - clamp(offsetY, clientOffsety, clientOffsety + clientHeight)) / elementHeight;\n        var intersectX = visibleX === 1 ? 0 : sign(offsetX - clientOffsetX);\n        var intersectY = visibleY === 1 ? 0 : sign(offsetY - clientOffsety);\n        var viewportX = clamp((clientOffsetX - (elementWidth / 2 + offsetX - clientWidth / 2)) / (clientWidth / 2), -1, 1);\n        var viewportY = clamp((clientOffsety - (elementHeight / 2 + offsetY - clientHeight / 2)) / (clientHeight / 2), -1, 1);\n        var visible = void 0;\n\n        if (opts.offset) {\n          visible = unwrap(opts.offset, element, ctx, doc) <= clientOffsety ? 1 : 0;\n        } else if ((unwrap(opts.threshold, element, ctx, doc) || 0) < visibleX * visibleY) {\n          visible = 1;\n        } else {\n          visible = 0;\n        }\n\n        var changedVisible = ctx.visible !== visible;\n        var changed = ctx._changed || changedVisible || ctx.visibleX !== visibleX || ctx.visibleY !== visibleY || ctx.index !== index_1 || ctx.elementHeight !== elementHeight || ctx.elementWidth !== elementWidth || ctx.offsetX !== offsetX || ctx.offsetY !== offsetY || ctx.intersectX !== ctx.intersectX || ctx.intersectY !== ctx.intersectY || ctx.viewportX !== viewportX || ctx.viewportY !== viewportY;\n\n        if (changed) {\n          childChanged = true;\n          ctx._changed = true;\n          ctx._visibleChanged = changedVisible;\n          ctx.visible = visible;\n          ctx.elementHeight = elementHeight;\n          ctx.elementWidth = elementWidth;\n          ctx.index = index_1;\n          ctx.offsetX = offsetX;\n          ctx.offsetY = offsetY;\n          ctx.visibleX = visibleX;\n          ctx.visibleY = visibleY;\n          ctx.intersectX = intersectX;\n          ctx.intersectY = intersectY;\n          ctx.viewportX = viewportX;\n          ctx.viewportY = viewportY;\n          ctx.visible = visible;\n        }\n      }\n\n      if (!sub && (rootChanged || childChanged)) {\n        sub = subscribe(render);\n      }\n    }\n\n    function render() {\n      maybeUnsubscribe(); // Update root attributes if they have changed.\n\n      if (rootChanged) {\n        rootChanged = false;\n        setAttrs(doc, {\n          scrollDirX: scrollingElementContext.scrollDirX,\n          scrollDirY: scrollingElementContext.scrollDirY\n        });\n        props(doc, scrollingElementContext);\n        onScroll(doc, scrollingElementContext, elementContextList);\n      }\n\n      var len = elementContextList.length;\n\n      for (var x = len - 1; x > -1; x--) {\n        var ctx = elementContextList[x];\n        var el = ctx.element;\n        var visible = ctx.visible;\n        var justOnce = el.hasAttribute('scrollout-once') || false; // Once\n\n        if (ctx._changed) {\n          ctx._changed = false;\n          props(el, ctx);\n        }\n\n        if (ctx._visibleChanged) {\n          setAttrs(el, {\n            scroll: visible ? 'in' : 'out'\n          });\n          onChange(el, ctx, doc);\n          (visible ? onShown : onHidden)(el, ctx, doc);\n        } // if this is shown multiple times, keep it in the list\n\n\n        if (visible && (opts.once || justOnce)) {\n          // or if this element just display it once\n          elementContextList.splice(x, 1);\n        }\n      }\n    }\n\n    function maybeUnsubscribe() {\n      if (sub) {\n        sub();\n        sub = undefined;\n      }\n    } // Run initialize index.\n\n\n    index();\n    update();\n    render(); // Collapses sequential updates into a single update.\n\n    var updateTaskId = 0;\n\n    var onUpdate = function onUpdate() {\n      updateTaskId = updateTaskId || setTimeout(function () {\n        updateTaskId = 0;\n        update();\n      }, 0);\n    }; // Hook up document listeners to automatically detect changes.\n\n\n    window.addEventListener('resize', onUpdate);\n    container.addEventListener('scroll', onUpdate);\n    return {\n      index: index,\n      update: update,\n      teardown: function teardown() {\n        maybeUnsubscribe();\n        window.removeEventListener('resize', onUpdate);\n        container.removeEventListener('scroll', onUpdate);\n      }\n    };\n  }\n\n  return main;\n}();","map":{"version":3,"sources":["/Users/macbookair11/code/ahmedkucuk23/mita/app/javascript/custom/scroll-out.js"],"names":["ScrollOut","clamp","v","min","max","sign","x","round","n","Math","cache","replacer","match","toLowerCase","hyphenate","value","replace","$","e","parent","length","nodeName","slice","call","document","documentElement","querySelectorAll","setAttrs","el","attrs","key","indexOf","setAttribute","setProps","cssProps","props","style","setProperty","clearTask","subscribers","loop","forEach","s2","enqueue","requestAnimationFrame","subscribe","fn","push","filter","s","cancelAnimationFrame","unwrap","ctx","doc","noop","main","opts","onChange","onHidden","onShown","onScroll","se","scrollingElement","container","window","rootChanged","scrollingElementContext","elementContextList","clientOffsetX","clientOffsety","sub","index","targets","scope","map","element","update","clientWidth","clientHeight","scrollDirX","scrollLeft","pageXOffset","scrollDirY","scrollTop","pageYOffset","scrollPercentX","scrollWidth","scrollPercentY","scrollHeight","childChanged","index_1","target","offsetX","offsetY","offsetLeft","offsetTop","offsetParent","elementHeight","offsetHeight","elementWidth","offsetWidth","visibleX","visibleY","intersectX","intersectY","viewportX","viewportY","visible","offset","threshold","changedVisible","changed","_changed","_visibleChanged","render","maybeUnsubscribe","len","justOnce","hasAttribute","scroll","once","splice","undefined","updateTaskId","onUpdate","setTimeout","addEventListener","teardown","removeEventListener"],"mappings":"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","sourcesContent":["var ScrollOut = (function () {\n  'use strict';\n\n  function clamp(v, min, max) {\n      return min > v ? min : max < v ? max : v;\n  }\n  function sign(x) {\n      return (+(x > 0) - +(x < 0));\n  }\n  function round(n) {\n      return Math.round(n * 10000) / 10000;\n  }\n\n  var cache = {};\n  function replacer(match) {\n      return '-' + match[0].toLowerCase();\n  }\n  function hyphenate(value) {\n      return cache[value] || (cache[value] = value.replace(/([A-Z])/g, replacer));\n  }\n\n  /** find elements */\n  function $(e, parent) {\n      return !e || e.length === 0\n          ? // null or empty string returns empty array\n              []\n          : e.nodeName\n              ? // a single element is wrapped in an array\n                  [e]\n              : // selector and NodeList are converted to Element[]\n                  [].slice.call(e[0].nodeName ? e : (parent || document.documentElement).querySelectorAll(e));\n  }\n  function setAttrs(el, attrs) {\n      // tslint:disable-next-line:forin\n      for (var key in attrs) {\n          if (key.indexOf('_')) {\n              el.setAttribute('data-' + hyphenate(key), attrs[key]);\n          }\n      }\n  }\n  function setProps(cssProps) {\n      return function (el, props) {\n          for (var key in props) {\n              if (key.indexOf('_') && (cssProps === true || cssProps[key])) {\n                  el.style.setProperty('--' + hyphenate(key), round(props[key]));\n              }\n          }\n      };\n  }\n\n  var clearTask;\n  var subscribers = [];\n  function loop() {\n      clearTask = 0;\n      subscribers.slice().forEach(function (s2) { return s2(); });\n      enqueue();\n  }\n  function enqueue() {\n      if (!clearTask && subscribers.length) {\n          clearTask = requestAnimationFrame(loop);\n      }\n  }\n  function subscribe(fn) {\n      subscribers.push(fn);\n      enqueue();\n      return function () {\n          subscribers = subscribers.filter(function (s) { return s !== fn; });\n          if (!subscribers.length && clearTask) {\n              cancelAnimationFrame(clearTask);\n              clearTask = 0;\n          }\n      };\n  }\n\n  function unwrap(value, el, ctx, doc) {\n      return typeof value === 'function' ? value(el, ctx, doc) : value;\n  }\n  function noop() { }\n\n  /**\n   * Creates a new instance of ScrollOut that marks elements in the viewport with\n   * an \"in\" class and marks elements outside of the viewport with an \"out\"\n   */\n  // tslint:disable-next-line:no-default-export\n  function main (opts) {\n      // Apply default options.\n      opts = opts || {};\n      // Debounce onChange/onHidden/onShown.\n      var onChange = opts.onChange || noop;\n      var onHidden = opts.onHidden || noop;\n      var onShown = opts.onShown || noop;\n      var onScroll = opts.onScroll || noop;\n      var props = opts.cssProps ? setProps(opts.cssProps) : noop;\n      var se = opts.scrollingElement;\n      var container = se ? $(se)[0] : window;\n      var doc = se ? $(se)[0] : document.documentElement;\n      var rootChanged = false;\n      var scrollingElementContext = {};\n      var elementContextList = [];\n      var clientOffsetX, clientOffsety;\n      var sub;\n      function index() {\n          elementContextList = $(opts.targets || '[data-scroll]', $(opts.scope || doc)[0]).map(function (el) { return ({ element: el }); });\n      }\n      function update() {\n          // Calculate position, direction and ratio.\n          var clientWidth = doc.clientWidth;\n          var clientHeight = doc.clientHeight;\n          var scrollDirX = sign(-clientOffsetX + (clientOffsetX = doc.scrollLeft || window.pageXOffset));\n          var scrollDirY = sign(-clientOffsety + (clientOffsety = doc.scrollTop || window.pageYOffset));\n          var scrollPercentX = doc.scrollLeft / (doc.scrollWidth - clientWidth || 1);\n          var scrollPercentY = doc.scrollTop / (doc.scrollHeight - clientHeight || 1);\n          // Detect if the root context has changed.\n          rootChanged =\n              rootChanged ||\n                  scrollingElementContext.scrollDirX !== scrollDirX ||\n                  scrollingElementContext.scrollDirY !== scrollDirY ||\n                  scrollingElementContext.scrollPercentX !== scrollPercentX ||\n                  scrollingElementContext.scrollPercentY !== scrollPercentY;\n          scrollingElementContext.scrollDirX = scrollDirX;\n          scrollingElementContext.scrollDirY = scrollDirY;\n          scrollingElementContext.scrollPercentX = scrollPercentX;\n          scrollingElementContext.scrollPercentY = scrollPercentY;\n          var childChanged = false;\n          for (var index_1 = 0; index_1 < elementContextList.length; index_1++) {\n              var ctx = elementContextList[index_1];\n              var element = ctx.element;\n              // find the distance from the element to the scrolling container\n              var target = element;\n              var offsetX = 0;\n              var offsetY = 0;\n              do {\n                  offsetX += target.offsetLeft;\n                  offsetY += target.offsetTop;\n                  target = target.offsetParent;\n              } while (target && target !== container);\n              // Get element dimensions.\n              var elementHeight = element.clientHeight || element.offsetHeight || 0;\n              var elementWidth = element.clientWidth || element.offsetWidth || 0;\n              // Find visible ratios for each element.\n              var visibleX = (clamp(offsetX + elementWidth, clientOffsetX, clientOffsetX + clientWidth) -\n                  clamp(offsetX, clientOffsetX, clientOffsetX + clientWidth)) /\n                  elementWidth;\n              var visibleY = (clamp(offsetY + elementHeight, clientOffsety, clientOffsety + clientHeight) -\n                  clamp(offsetY, clientOffsety, clientOffsety + clientHeight)) /\n                  elementHeight;\n              var intersectX = visibleX === 1 ? 0 : sign(offsetX - clientOffsetX);\n              var intersectY = visibleY === 1 ? 0 : sign(offsetY - clientOffsety);\n              var viewportX = clamp((clientOffsetX - (elementWidth / 2 + offsetX - clientWidth / 2)) / (clientWidth / 2), -1, 1);\n              var viewportY = clamp((clientOffsety - (elementHeight / 2 + offsetY - clientHeight / 2)) / (clientHeight / 2), -1, 1);\n              var visible = void 0;\n              if (opts.offset) {\n                  visible = unwrap(opts.offset, element, ctx, doc) <= clientOffsety ? 1 : 0;\n              }\n              else if ((unwrap(opts.threshold, element, ctx, doc) || 0) < visibleX * visibleY) {\n                  visible = 1;\n              }\n              else {\n                  visible = 0;\n              }\n              var changedVisible = ctx.visible !== visible;\n              var changed = ctx._changed ||\n                  changedVisible ||\n                  ctx.visibleX !== visibleX ||\n                  ctx.visibleY !== visibleY ||\n                  ctx.index !== index_1 ||\n                  ctx.elementHeight !== elementHeight ||\n                  ctx.elementWidth !== elementWidth ||\n                  ctx.offsetX !== offsetX ||\n                  ctx.offsetY !== offsetY ||\n                  ctx.intersectX !== ctx.intersectX ||\n                  ctx.intersectY !== ctx.intersectY ||\n                  ctx.viewportX !== viewportX ||\n                  ctx.viewportY !== viewportY;\n              if (changed) {\n                  childChanged = true;\n                  ctx._changed = true;\n                  ctx._visibleChanged = changedVisible;\n                  ctx.visible = visible;\n                  ctx.elementHeight = elementHeight;\n                  ctx.elementWidth = elementWidth;\n                  ctx.index = index_1;\n                  ctx.offsetX = offsetX;\n                  ctx.offsetY = offsetY;\n                  ctx.visibleX = visibleX;\n                  ctx.visibleY = visibleY;\n                  ctx.intersectX = intersectX;\n                  ctx.intersectY = intersectY;\n                  ctx.viewportX = viewportX;\n                  ctx.viewportY = viewportY;\n                  ctx.visible = visible;\n              }\n          }\n          if (!sub && (rootChanged || childChanged)) {\n              sub = subscribe(render);\n          }\n      }\n      function render() {\n          maybeUnsubscribe();\n          // Update root attributes if they have changed.\n          if (rootChanged) {\n              rootChanged = false;\n              setAttrs(doc, {\n                  scrollDirX: scrollingElementContext.scrollDirX,\n                  scrollDirY: scrollingElementContext.scrollDirY\n              });\n              props(doc, scrollingElementContext);\n              onScroll(doc, scrollingElementContext, elementContextList);\n          }\n          var len = elementContextList.length;\n          for (var x = len - 1; x > -1; x--) {\n              var ctx = elementContextList[x];\n              var el = ctx.element;\n              var visible = ctx.visible;\n              var justOnce = el.hasAttribute('scrollout-once') || false; // Once\n              if (ctx._changed) {\n                  ctx._changed = false;\n                  props(el, ctx);\n              }\n              if (ctx._visibleChanged) {\n                  setAttrs(el, { scroll: visible ? 'in' : 'out' });\n                  onChange(el, ctx, doc);\n                  (visible ? onShown : onHidden)(el, ctx, doc);\n              }\n              // if this is shown multiple times, keep it in the list\n              if (visible && (opts.once || justOnce)) { // or if this element just display it once\n                  elementContextList.splice(x, 1);\n              }\n          }\n      }\n      function maybeUnsubscribe() {\n          if (sub) {\n              sub();\n              sub = undefined;\n          }\n      }\n      // Run initialize index.\n      index();\n      update();\n      render();\n      // Collapses sequential updates into a single update.\n      var updateTaskId = 0;\n      var onUpdate = function () {\n          updateTaskId = updateTaskId || setTimeout(function () {\n              updateTaskId = 0;\n              update();\n          }, 0);\n      };\n      // Hook up document listeners to automatically detect changes.\n      window.addEventListener('resize', onUpdate);\n      container.addEventListener('scroll', onUpdate);\n      return {\n          index: index,\n          update: update,\n          teardown: function () {\n              maybeUnsubscribe();\n              window.removeEventListener('resize', onUpdate);\n              container.removeEventListener('scroll', onUpdate);\n          }\n      };\n  }\n\n  return main;\n\n}());\n"]},"metadata":{},"sourceType":"module"}